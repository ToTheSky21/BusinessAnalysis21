---
title: Final Project
author: R package build
date: '2021-06-21'
slug: final-project
categories:
  - tidymodels
  - Tidyverse
  - ggplot2
tags: []
---
## Data Analysis to fit Linear Regression Model:
This is an exploratory data analysis report to fit the simple Linear Regression Model. This report concerns a dataset about Life Expectancy.
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(tidymodels)
library(ggtext)
library(knitr)
library(kableExtra)
set.seed(1234)
options(dplyr.print_min = 10, dplyr.print_max = 6)
```
## Categorical and numerical explanatory variables analysis:

For finding whether there is any relation between the dataset or not, I have done some basic analysis to find the dependent and independent variables.From these analysis, the variable Life Expectancy has came out as dependent variable(y) as it is effected by other predictive variables.  

## Data: Life Expectancy

This Dataset is about Life Expectancy of different countries with several related variables(See below on printed Head of dataset). The data was collected from WHO and United Nations website aiming that this will help in suggesting a country which area should be given importance in order to efficiently improve the life expectancy of its population.Since the observations this dataset are based on different countries, it will be easier for a country to determine the predicting factor which is contributing to lower value of life expectancy.

I have collected this dataset from the following website: https://www.kaggle.com/kumarajarshi/life-expectancy-who
```{r echo=FALSE, warning=FALSE, message=FALSE}
le <- read_csv("Life Expectancy Data.csv", na = c("n/a", "", "NA"))
head(le)
```
## Exploring Dataset: 

Now, I will conduct some primary data visualization to explore the dataset with histogram, density plot, scatter plot, box plot and bar diagram which are shown below.

## Summary of Life expectancy, Adult Mortality and Hepatitis B:
The following visualizations are done to know the Summary of some of the variables at a glance which are known univariate analysis.
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(hrbrthemes)
h1 <- le %>%
  ggplot( aes(x=le$`Life expectancy`)) +
    geom_histogram( binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
    ggtitle("Summary of Life expectancy") +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=15)
    )
h1
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
library(hrbrthemes)
h2 <- le %>%
  ggplot( aes(x=le$`Adult Mortality`)) +
    geom_histogram( binwidth=15, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
    ggtitle("Summary of Adult Mortality") +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=15)
    )
h2
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
library(hrbrthemes)
h3 <- le %>%
  ggplot( aes(x=le$`Hepatitis B`)) +
    geom_histogram( binwidth=10, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
    ggtitle("Summary of Hepatitis B") +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=15)
    )
h3
```
## GDP at a glance:
```{r echo=FALSE, warning=FALSE, message=FALSE}
le %>%
  ggplot( aes(x=GDP)) +
    geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8) +
    ggtitle("GDP of WHO Life expectancy dataset") +
    theme_ipsum()
```
## Bosxplot of Schooling by Percentage Expenditure:
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(hrbrthemes)
library(viridis)
le %>%
  ggplot( aes(x=le$`Total expenditure`, y=Schooling, fill=le$`Total expenditure`)) +
    geom_boxplot() +
    scale_fill_viridis(discrete = TRUE, alpha=0.6, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    ggtitle("Boxplot of Schooling by Total Expenditure") +
    xlab("Total expenditure")
```
## GDP by POPULATION
The following basic scatter plot is done to understand the relation between Population and GDP. It shows countries with highest GDP has lower population.
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(hrbrthemes)
df1 <- data.frame(le$Population, le$GDP)
#na.omit(df1)
ggplot(df1, mapping=aes(x=le$Population, y=le$GDP, alpha=0.6)) +
  geom_point(size=4, color="#69b3a2") +
  labs(tittle = "GDP vs POPULATION",
     x = "POPULATION",
     y = "GDP") +
    theme_ipsum()
```
## Life Expectancy by Year:
To know whether the Life Expectancy is changing by Year or not I have chosen one Country(Canada). Here, it shows
that in the Year 2006 to 2008 it has changed and then resulted the same ages of life expectancy. 
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(tidyverse)
library(dplyr)
library(plyr)
df2 <- le %>%
filter(Country == "Canada")
ggplot(df2, mapping=aes(x=df2$Year, y=df2$`Life expectancy`)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    labs(tittle = "Year vs Life Expectancy",
     x = "Year",
     y = "Life expectancy")
```
## Hepatitis B by Alcohol:
This plot shows how these Alcohol and Hepatitis B are related.This plot shows the percent of immunization for Hepatitis B are not positively related to Alcohol consumption,where Alcohol is recorded per capita (15+) consumption (in litres of pure alcohol) and Hepatitis B (HepB) as immunization coverage among 1-year-olds (%).
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(stats)
dfsc <- data.frame(le$Alcohol, le$`Hepatitis B`)
scatter.smooth(x=le$Alcohol, y=le$`Hepatitis B`, main="Alcohol vs Hepatitis B")

```
## Adult Mortality by Alcohol:
Here the variable Adult Mortality Rates are calculated for both sexes (probability of dying between 15 and 60 years per 1000 population). The more Alcohol consumption is not indicating higher Adult Mortality rate.
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(hrbrthemes)
df3 <- data.frame(le$Alcohol, le$`Adult Mortality`)
#na.omit(df3)
ggplot(df3, mapping=aes(x=le$Alcohol, y=le$`Adult Mortality`, alpha=0.5)) +
  geom_point(size=4, color="#69b3a2") +
  labs(tittle = "Alcohol vs Adult Mortality",
     x = "Alcohol",
     y = "Adult Mortality") +
    theme_ipsum()
```
## Adding Linear Regression lines to the plotted variables 
Before fitting the Linear Regression model with one independent variable,I have visualized the relationship between some independent variables with the dependent variable,Life expectancy. 

##Life expectancy by GDP:
```{r  echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data = le, aes(x = le$GDP, y = le$`Life expectancy`)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "#8E2C90") +
  labs(
    title = "GDP vs. Life expectancy",
    x = "GDP",
    y = "Life Expectancy"
  )
```
## Life expectancy by Adult Mortality:
```{r  echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data = le, aes(y = le$`Life expectancy`, x = le$`Adult Mortality`)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "#8E2C90") +
  labs(
    title = "Adult Mortality vs. Life expectancy",
    x = "Adult Mortality",
    y = "Life expectancy"
  )
```
## Life expectancy by Percentage Expenditure: 
```{r  echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data = le, aes(y = le$`Life expectancy`, x = le$`percentage expenditure`)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "#8E2C90") +
  labs(
    title = "Percentage Expenditure vs. Life expectancy",
    x = "Percentage Expenditure",
    y = "Life Expectancy"
  )
```
## Life Expectancy by Income composition of resources:
```{r  echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data = le, aes(y = le$`Life expectancy`, x = le$`Income composition of resources`)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "#8E2C90") +
  labs(
    title = "Income composition of resources vs. Life Expectancy",
    x = "Income composition of resources",
    y = "Life Expectancy"
  )
```
## Life Expectancy by Schooling:
```{r  echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data = le, aes(y = le$`Life expectancy`, x = le$Schooling)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "#8E2C90") +
  labs(
    title = "Schooling vs. Life Expectancy",
    x = "Schooling(in year)",
    y = "Life Expectancy(in age)"
  )
```
## Fitting and Interpretting Linear Regression Model:

In this data set there are several independent variables, but for fitting Linear Regression model I have chosen one predictor, namely Schooling for further steps.Now, the goal is to predict Life Expectancy(in age) from Schooling, number of years of Schooling(years).

The function is: Life Expectancy = β0 + β1 * Schooling where, “β0” and "β1” are the intercept and the slope respectively.

## Step 1: Specify model
```{r echo=FALSE, warning=FALSE, message=FALSE}
linear_reg()
```
## Step 2: Set model fitting *engine*
```{r}
linear_reg() %>%
  set_engine("lm") # lm: linear model
```
## Step 3: Fit model & estimate parameters
```{r echo=FALSE, warning=FALSE, message=FALSE}
linear_reg() %>%
  set_engine("lm") %>%
  fit(le$`Life expectancy` ~ Schooling, data = le) 
```
## Closer look of the above output
```{r ref.label="fit-model", echo=FALSE}
```
.large[
$$\widehat{le$`Life expectancy`} = 44.109 + 2.103 \times Schooling$$
]
## Step 4: Tidy look of model & parameters 
```{r fit-model}
linear_reg() %>%
  set_engine("lm") %>%
  fit(le$`Life expectancy` ~ Schooling, data = le) %>%
  tidy()
```
.large[
$$\widehat{Life} {expectancy} = 44.108 + 2.103 \times {Schooling}$$
]

## Interpretation of model coefficients:

The values of the intercept (“β0” value) and the slope (“β1” value) for the Schooling. These “β0” and "β1" values plot a line between all the points of the data. So in this case, if there is a person who goes to school for 12 years,when β0 is 44.11 and β1 is 2.103, the model predicts (on average) that Life Expectancy in age is around 44.11 + (2.103 * 12) = 69.346 age.

In another words,Slope means for each additional year a person's  Life expectancy is increased, the Schooling year is also expected to be longer, on average, by 2.10 years.

And the intercept means a person who have 0 years school are expected to be 44.11 ages of Life Expectancy , on average. 